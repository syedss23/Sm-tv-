<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Series List â€“ SmTv Urdu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="All Turkish drama series in Urdu, English, and Hindi subtitles. Watch historical shows online on SmTv Urdu.">
  <link rel="stylesheet" href="style.css">

  <style>
    body { background:#0b0d10; color:#fff; margin:0; font-family:'Segoe UI',Arial,sans-serif; }
    .container { max-width:1100px; margin:0 auto; padding:14px; }

    .page-title { color:#fff; font-size:20px; font-weight:700; margin:12px 0 18px; text-align:center; }

    /* Filter bar */
    .filter-bar { display:flex; justify-content:center; gap:10px; margin-bottom:14px; flex-wrap:wrap; }
    .filter-btn {
      border:none;
      border-radius:30px;
      padding:10px 18px;
      font-size:15px;
      font-weight:600;
      cursor:pointer;
      background:#1e2630;
      color:#fff;
      transition:all .2s;
    }
    .filter-btn.active {
      background:linear-gradient(135deg,#00bcd4,#007bff);
      color:#fff;
      box-shadow:0 0 10px rgba(0,188,212,0.4);
    }

    /* Sub-language buttons */
    .sub-lang-bar { display:none; justify-content:center; gap:10px; margin-bottom:18px; flex-wrap:wrap; }
    .sub-lang-bar.active { display:flex; }
    .sub-btn {
      border:none;
      border-radius:20px;
      padding:8px 16px;
      font-size:14px;
      cursor:pointer;
      background:#1b2430;
      color:#ddd;
      transition:.2s;
    }
    .sub-btn.active {
      background:#ff9800;
      color:#000;
      font-weight:700;
    }

    /* Series grid */
    .series-grid {
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:12px;
    }
    @media(min-width:700px){ .series-grid{grid-template-columns:repeat(3,1fr);} }
    @media(min-width:1000px){ .series-grid{grid-template-columns:repeat(4,1fr);} }

    .series-card {
      display:block;
      background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.12));
      border-radius:12px;
      overflow:hidden;
      color:#fff;
      box-shadow:0 8px 20px rgba(0,0,0,0.45);
      transition:transform .18s ease,box-shadow .18s ease;
      text-decoration:none;
    }
    .series-card:hover { transform:translateY(-6px); box-shadow:0 12px 30px rgba(0,0,0,0.55); }
    .series-thumb { width:100%; height:0; padding-bottom:56%; position:relative; background:#111; }
    .series-thumb img { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; }
    .series-title { padding:10px 12px; font-size:15px; font-weight:600; text-align:center; background:rgba(0,0,0,0.1); }
    #series-empty { display:none; color:#ccc; text-align:center; margin-top:30px; }
  </style>
</head>
<body>
  <div class="container">
    <header class="page-title">All Series</header>

    <!-- Filters -->
    <div class="filter-bar">
      <button class="filter-btn active" id="dubbedBtn">Dubbed</button>
      <button class="filter-btn" id="subBtn">Subtitles</button>
    </div>

    <!-- Sub-language buttons -->
    <div class="sub-lang-bar" id="subLangBar">
      <button class="sub-btn" data-lang="en">English</button>
      <button class="sub-btn" data-lang="hi">Hindi</button>
      <button class="sub-btn" data-lang="ur">Urdu</button>
    </div>

    <!-- Series grid -->
    <div id="series-list" class="series-grid"></div>
    <div id="series-empty">No series found.</div>
  </div>

  <script>
    (async function(){
      const grid = document.getElementById('series-list');
      const empty = document.getElementById('series-empty');
      const dubbedBtn = document.getElementById('dubbedBtn');
      const subBtn = document.getElementById('subBtn');
      const subLangBar = document.getElementById('subLangBar');
      const subBtns = subLangBar.querySelectorAll('.sub-btn');

      let allSeries = [];
      try {
        const res = await fetch('series.json');
        if(!res.ok) throw new Error('Failed to load series.json');
        allSeries = await res.json();
      } catch(e) {
        console.error(e);
        empty.style.display='block';
        return;
      }

      function render(filter){
        const filtered = allSeries.filter(s=>{
          if(filter.type==='dubbed') return s.track==='dubbed';
          if(filter.type==='sub'){
            if(!filter.lang) return s.track==='sub';
            return s.track==='sub' && s.subLang===filter.lang;
          }
        });
        if(filtered.length===0){ grid.innerHTML=''; empty.style.display='block'; return;}
        empty.style.display='none';
        grid.innerHTML = filtered.map(s=>`
          <a class="series-card" href="series.html?series=${encodeURIComponent(s.slug)}${filter.type==='sub' && filter.lang ? '&lang='+filter.lang : ''}">
            <div class="series-thumb"><img src="${s.poster}" alt="${s.title}"></div>
            <div class="series-title">${s.title}</div>
          </a>
        `).join('');
      }

      let currentFilter = { type:'dubbed' };
      render(currentFilter);

      dubbedBtn.onclick = ()=>{
        currentFilter = { type:'dubbed' };
        dubbedBtn.classList.add('active');
        subBtn.classList.remove('active');
        subLangBar.classList.remove('active');
        render(currentFilter);
      };

      subBtn.onclick = ()=>{
        currentFilter = { type:'sub' };
        subBtn.classList.add('active');
        dubbedBtn.classList.remove('active');
        subLangBar.classList.add('active');
        subBtns.forEach(b=>b.classList.remove('active'));
        const saved = localStorage.getItem('smtv_sub_lang') || 'en';
        const btn = [...subBtns].find(b=>b.dataset.lang===saved) || subBtns[0];
        btn.classList.add('active');
        currentFilter.lang = btn.dataset.lang;
        render(currentFilter);
      };

      subBtns.forEach(b=>{
        b.onclick = ()=>{
          subBtns.forEach(x=>x.classList.remove('active'));
          b.classList.add('active');
          currentFilter = { type:'sub', lang:b.dataset.lang };
          localStorage.setItem('smtv_sub_lang', b.dataset.lang);
          render(currentFilter);
        };
      });
    })();
  </script>
  <!-- FOOTER: load includes/footer.html (robust loader + fallback) -->
<div id="footer-placeholder"></div>

<script>
(async function loadFooterRobust(){
  // candidate footer paths (tries multiple common locations)
  const candidates = [
    '/includes/footer.html',
    'includes/footer.html',
    './includes/footer.html',
    '/footer.html',
    'footer.html'
  ];

  const placeholder = document.getElementById('footer-placeholder');

  // helper to insert and initialize nav
  function initNav(html) {
    try {
      placeholder.innerHTML = html;
      // Ensure body has space so content isn't hidden under nav
      try {
        const curPad = parseInt(getComputedStyle(document.body).paddingBottom) || 0;
        const minPad = 96;
        if (curPad < minPad) document.body.style.paddingBottom = 'calc(96px + env(safe-area-inset-bottom))';
      } catch(e){}

      // Activate the "Series" nav item (look for dataset.name or href)
      const nav = placeholder.querySelector('#smtv-bottom-nav') || placeholder.querySelector('.smtv-bottom-nav');
      if (!nav) return;

      const items = Array.from(nav.querySelectorAll('.nav-item'));
      items.forEach(i => i.classList.remove('active'));

      // Prefer explicit dataset.name === 'series', otherwise href contains 'series'
      let seriesItem = items.find(i => ((i.dataset && (i.dataset.name || '').toLowerCase()) === 'series'));
      if (!seriesItem) {
        seriesItem = items.find(i => {
          const href = (i.getAttribute && i.getAttribute('href') || '').toLowerCase();
          return href && href.includes('series');
        });
      }

      // If opened from a series page (query param ?series=), prefer the series nav
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.has('series') && seriesItem) {
        seriesItem.classList.add('active');
      } else {
        // fallback: match by pathname
        const path = location.pathname.toLowerCase();
        const byPath = items.find(i => (i.getAttribute('href')||'').toLowerCase().includes(path.split('/').pop()));
        if (byPath) byPath.classList.add('active');
        else if (seriesItem) seriesItem.classList.add('active');
      }

      // Attach click handlers to nav items to highlight immediately and persist last-click
      items.forEach(a => {
        if (a._smtvInit) return;
        a._smtvInit = true;
        a.addEventListener('click', function(e){
          try { e.preventDefault && e.preventDefault(); } catch(err){}
          items.forEach(i => i.classList.remove('active'));
          this.classList.add('active');
          try { localStorage.setItem('smtv_last_nav', this.dataset.name || this.getAttribute('href')); } catch(e){}
          const href = this.getAttribute('href');
          if (href) location.assign(href);
        }, { passive: false });
      });

    } catch (e) {
      console.warn('initNav error', e);
    }
  }

  // try fetch candidates sequentially
  for (const cand of candidates) {
    try {
      const url = cand;
      const res = await fetch(url, { cache: 'no-cache' });
      if (!res.ok) continue;
      const text = await res.text();

      // quick sanity: must contain nav element marker
      if (text.includes('smtv-bottom-nav') || text.includes('smtv-bottom')) {
        initNav(text);
        return;
      } else {
        // still accept it (some builds may not use same class names)
        initNav(text);
        return;
      }
    } catch (e) {
      // try next candidate
      continue;
    }
  }

  // If all fetch attempts failed, insert a small inline fallback nav so page isn't missing the bar
  placeholder.innerHTML = `
    <nav class="smtv-bottom-nav" id="smtv-bottom-nav" role="navigation" aria-label="Main">
      <a href="/index.html" class="nav-item" data-name="home"><span class="icon-wrap"><i class="fa-solid fa-house"></i></span><span class="label">Home</span></a>
      <a href="/series.html" class="nav-item active" data-name="series"><span class="icon-wrap"><i class="fa-solid fa-film"></i></span><span class="label">Series</span></a>
      <a href="/clips.html" class="nav-item" data-name="clips"><span class="icon-wrap"><i class="fa-solid fa-play-circle"></i></span><span class="label">Clips</span></a>
      <a href="/premium.html" class="nav-item" data-name="premium"><span class="icon-wrap"><i class="fa-solid fa-star"></i></span><span class="label">Premium</span></a>
      <a href="/more.html" class="nav-item" data-name="more"><span class="icon-wrap"><i class="fa-solid fa-circle-info"></i></span><span class="label">More</span></a>
    </nav>
    <style>
      /* minimal inline style for fallback (keeps appearance acceptable) */
      .smtv-bottom-nav{position:fixed;left:12px;right:12px;bottom:12px;height:64px;display:flex;gap:6px;padding:8px;border-radius:14px;background:rgba(10,10,12,0.9);align-items:center;z-index:1200;padding-bottom:calc(env(safe-area-inset-bottom) + 8px);}
      .smtv-bottom-nav .nav-item{flex:1;text-align:center;color:#bdbdbd;text-decoration:none;padding:6px;border-radius:10px;}
      .smtv-bottom-nav .nav-item.active{color:#fff;transform:translateY(-6px);}
      .smtv-bottom-nav .icon-wrap{display:inline-flex;width:40px;height:40px;align-items:center;justify-content:center;border-radius:10px;}
      .smtv-bottom-nav .label{display:block;font-size:12px;margin-top:3px;}
    </style>
  `;
  // ensure padding
  try { document.body.style.paddingBottom = 'calc(96px + env(safe-area-inset-bottom))'; } catch(e){}
})();
</script>
</body>
</html>
