<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-WM3KEDD127"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-WM3KEDD127');
  </script>

  <meta charset="UTF-8">
  <title>SmTv Urdu</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="description" content="Watch Turkish drama series and historical shows in Urdu on SmTv Urdu. All series details and streaming links.">

  <link rel="stylesheet" href="style.css">

  <style>
    /* Page basics */
    body { background:#0b0d10; color:#fff; margin:0; font-family: 'Segoe UI', Arial, sans-serif; }
    .container { max-width:1100px; margin:0 auto; padding:14px; }

    /* Title */
    .page-title { text-align:center; font-weight:800; font-size:22px; color:#fff; margin:8px 0 18px; }

    /* Filters for list view */
    .filter-bar { display:flex; gap:10px; justify-content:center; margin-bottom:12px; flex-wrap:wrap; }
    .filter-btn {
      border:none; border-radius:30px; padding:10px 18px; font-size:15px; font-weight:700; cursor:pointer;
      background:#1e2630; color:#fff; transition:all .18s;
    }
    .filter-btn.active { background:linear-gradient(135deg,#ffcf33,#ff7a5f); color:#111; box-shadow:0 8px 24px rgba(255,124,60,0.12); }

    .sub-lang-bar { display:none; gap:10px; justify-content:center; margin-bottom:18px; flex-wrap:wrap; }
    .sub-lang-bar.active { display:flex; }
    .sub-btn { border:none; border-radius:20px; padding:8px 14px; font-weight:700; cursor:pointer; background:#1b2430; color:#ddd; }
    .sub-btn.active { background:#00d0f0; color:#021; }

    /* Series grid (list view) */
    .series-grid {
      display:grid; grid-template-columns:repeat(2,1fr); gap:12px;
    }
    @media(min-width:700px){ .series-grid{grid-template-columns:repeat(3,1fr);} }
    @media(min-width:1000px){ .series-grid{grid-template-columns:repeat(4,1fr);} }

    .series-card {
      display:block; background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(0,0,0,0.08));
      border-radius:12px; overflow:hidden; color:#fff; text-decoration:none; padding-bottom:6px;
      box-shadow:0 8px 18px rgba(0,0,0,0.5);
    }
    .series-thumb { width:100%; height:0; padding-bottom:56%; position:relative; background:#111; border-radius:8px 8px 0 0; overflow:hidden; }
    .series-thumb img { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; display:block; }
    .series-title { padding:10px; font-size:15px; font-weight:800; color:#fff; text-align:center; }

    #series-empty { display:none; color:#ccc; text-align:center; margin-top:30px; }

    /* Series details area (series.js injects markup into #series-details) */
    #series-details { margin-top:6px; }

    /* Header inside details (centered poster & back button overlay) */
    .pro-series-header-pro {
      display:flex; flex-direction:column; align-items:center; gap:14px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
      padding:18px; border-radius:14px; box-shadow:0 8px 24px rgba(0,0,0,0.45);
      position:relative;
    }
    .pro-series-back-btn-pro {
      position:absolute; left:14px; top:14px; width:48px; height:48px; display:inline-flex; align-items:center; justify-content:center;
      border-radius:12px; background: rgba(0, 160, 210, 0.08); border:2px solid rgba(0,150,200,0.12); text-decoration:none;
    }
    .pro-series-poster-pro { width:180px; height:100px; border-radius:10px; object-fit:cover; box-shadow:0 8px 18px rgba(0,0,0,0.45); }
    .pro-series-title-pro { font-size:22px; color:#00d0f0; margin:6px 0; text-align:center; font-weight:900; }
    .pro-series-desc-pro { color:#cfd8df; text-align:center; line-height:1.5; max-width:820px; }

    /* Seasons tabs */
    .pro-seasons-tabs-pro { display:flex; gap:12px; justify-content:center; margin-top:14px; flex-wrap:wrap; }
    .pro-season-tab-pro {
      background: rgba(255,255,255,0.03); border: none; padding:10px 18px; border-radius:12px; color:#ddd; font-weight:800;
    }
    .pro-season-tab-pro.active { background: linear-gradient(90deg,#ffcf33,#ff7a5f); color:#111; transform:translateY(-4px); box-shadow:0 8px 24px rgba(255,124,60,0.14); }

    /* ---------- Horizontal episodes carousel (KEY CHANGE) ---------- */
    .pro-episodes-row-pro {
      display:flex;
      gap:16px;
      overflow-x:auto;
      padding:18px 10px;
      scroll-snap-type:x mandatory;
      -webkit-overflow-scrolling:touch;
      align-items:flex-start;
    }
    /* each episode card in carousel */
    .pro-episode-card-pro {
      flex:0 0 200px; /* card width; adjust for desired size */
      width:200px;
      display:flex;
      flex-direction:column;
      gap:8px;
      text-decoration:none;
      color:#fff;
      border-radius:12px;
      padding:12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.06));
      box-shadow: 0 12px 30px rgba(0,0,0,0.45);
      scroll-snap-align:center;
      align-items:center;
      transform-origin:center;
      transition: transform .14s ease, box-shadow .14s ease;
    }
    .pro-episode-card-pro:focus,
    .pro-episode-card-pro:hover,
    .pro-episode-card-pro.active {
      transform: translateY(-8px) scale(1.03);
      box-shadow: 0 18px 40px rgba(0,0,0,0.6);
    }

    .pro-ep-thumb-wrap-pro { position:relative; width:100%; padding-bottom:56%; border-radius:10px; overflow:hidden; background:#0f1720; }
    .pro-ep-thumb-pro { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; display:block; }
    .pro-ep-num-pro { position:absolute; right:8px; top:8px; background:linear-gradient(90deg,#ffcf33,#ff7a5f); color:#111; padding:6px 10px; border-radius:22px; font-weight:800; }
    .pro-ep-title-pro { text-align:center; font-weight:800; margin-top:6px; color:#fff; font-size:15px; }

    /* Make carousel look good on very small screens */
    @media (max-width:420px) {
      .pro-episode-card-pro { flex:0 0 160px; width:160px; padding:10px; }
      .pro-ep-num-pro { font-size:12px; padding:4px 8px; }
      .pro-series-poster-pro { width:150px; height:88px; }
    }

    /* How-to highlight style (used for tutorial titles) */
    .pro-highlight-title {
      background: linear-gradient(90deg, rgba(0,0,0,0.14), rgba(0,0,0,0.14));
      border-radius:10px;
      padding:14px 16px;
      color:#fff;
      font-weight:800;
      font-size:20px;
      display:block;
      position:relative;
      margin:18px 0 12px 0;
    }
    .pro-highlight-title::before {
      content:'';
      position:absolute; left:8px; top:8px; bottom:8px; width:8px; border-radius:8px; background:linear-gradient(180deg,#ffd400,#ff7a5f);
    }

    /* tutorial frame */
    .pro-video-frame-wrap { margin-top:12px; border-radius:12px; overflow:hidden; }

    /* Footer safe area */
    @media (max-width:600px) {
      body { padding-bottom: calc(120px + env(safe-area-inset-bottom)); }
    }
  </style>

  <!-- series.js injects details when ?series=slug - keep your existing script -->
  <script defer src="/series.js"></script>
</head>
<body>
  <div class="container">
    <header class="page-title">Series</header>

    <!-- Filters (series list view) -->
    <div class="filter-bar" id="filterBar">
      <button class="filter-btn active" id="dubbedBtn">Dubbed</button>
      <button class="filter-btn" id="subBtn">Subtitles</button>
    </div>

    <!-- sub-language bar (hidden until Subtitles selected) -->
    <div class="sub-lang-bar" id="subLangBar">
      <button class="sub-btn" data-lang="en">English</button>
      <button class="sub-btn" data-lang="hi">Hindi</button>
      <button class="sub-btn" data-lang="ur">Urdu</button>
    </div>

    <!-- Series list area (visible only when no ?series=slug) -->
    <div id="series-list-area">
      <div id="series-list" class="series-grid" aria-live="polite"></div>
      <div id="series-empty">No Series found.</div>
    </div>

    <!-- Series details (populated by /series.js when ?series=slug) -->
    <div id="series-details" style="display:none;"></div>
  </div>

  <!-- WhatsApp Popup -->
  <div id="whatsappPopup"
       style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); max-width:340px; width:90vw; box-shadow:0 8px 24px rgba(15,18,30,.13); border-radius:22px; background:#232936; color:#fff; padding:28px; font-size:1.09em; text-align:left;">
    <div style="display:flex; align-items:center; gap:12px; margin-bottom:10px;">
      <img src="favicon.png" alt="Channel Logo" style="width:40px; height:40px; border-radius:18px;">
      <span style="font-weight:700; font-size:1.18em;">Stay Updated!</span>
    </div>
    <div style="margin-bottom:16px;">Get instant notifications for new episodes and exclusive news.<br>Join our WhatsApp Channel now.</div>
    <div style="text-align:center;">
      <a href="https://whatsapp.com/channel/0029Va9zAvvAYlUNRuzWqh0k" target="_blank"
         style="display:inline-block; background:#29a345; color:#fff; font-weight:600; border-radius:11px; padding:11px 26px; text-decoration:none;">ðŸŸ¢ Join on WhatsApp</a>
      <br>
      <button id="closeWhatsAppPopup" style="background:none; border:none; color:#ff6868; font-weight:600; font-size:1.12em; margin-top:7px; cursor:pointer;">âœ– Close</button>
    </div>
  </div>

  <script>
  (function(){
    const qs = new URLSearchParams(location.search);
    const slug = qs.get('series');
    const listArea = document.getElementById('series-list-area');
    const detailsArea = document.getElementById('series-details');
    const grid = document.getElementById('series-list');
    const empty = document.getElementById('series-empty');

    const dubbedBtn = document.getElementById('dubbedBtn');
    const subBtn = document.getElementById('subBtn');
    const subLangBar = document.getElementById('subLangBar');
    const subBtns = Array.from(subLangBar.querySelectorAll('.sub-btn'));

    // If slug present -> let /series.js render details; hide list
    if (slug) {
      listArea.style.display = 'none';
      detailsArea.style.display = ''; // series.js will inject UI here
    } else {
      // show list view
      listArea.style.display = '';
      detailsArea.style.display = 'none';

      // load series.json from root (series.json is in your repo root)
      let allSeries = [];
      fetch('/series.json', {cache:'no-cache'}).then(r=>{
        if(!r.ok) throw new Error('series.json fetch failed ' + r.status);
        return r.json();
      }).then(data=>{
        allSeries = Array.isArray(data) ? data : (data && Array.isArray(data.series) ? data.series : []);
        // default filter = dubbed
        render({ type:'dubbed' });
      }).catch(err=>{
        console.warn('Could not load series.json', err);
        empty.textContent = 'Could not load list.';
        empty.style.display = 'block';
      });

      function render(filter) {
        const arr = allSeries || [];
        const filtered = arr.filter(s=>{
          if(filter.type === 'dubbed') return s.track === 'dubbed';
          if(filter.type === 'sub') {
            if(!filter.lang) return s.track === 'sub';
            return s.track === 'sub' && (s.subLang === filter.lang || (Array.isArray(s.subLangs) && s.subLangs.includes(filter.lang)));
          }
          return false;
        });
        if(!filtered || filtered.length === 0) { grid.innerHTML=''; empty.style.display='block'; return; }
        empty.style.display='none';
        grid.innerHTML = filtered.map(s=>`
          <a class="series-card" href="series.html?series=${encodeURIComponent(s.slug)}" aria-label="${escapeHtml(s.title||'Series')}">
            <div class="series-thumb"><img src="${escapeHtml(s.poster||'')}" alt="${escapeHtml(s.title||'')}" loading="lazy"></div>
            <div class="series-title">${escapeHtml(s.title||'Untitled')}</div>
          </a>
        `).join('');
      }

      // Filter buttons
      dubbedBtn.addEventListener('click', ()=>{
        dubbedBtn.classList.add('active'); subBtn.classList.remove('active');
        subLangBar.classList.remove('active');
        render({ type:'dubbed' });
      });
      subBtn.addEventListener('click', ()=>{
        subBtn.classList.add('active'); dubbedBtn.classList.remove('active');
        subLangBar.classList.add('active');
        // set a preselected language if you want: default 'ur'
        subBtns.forEach(b=>b.classList.remove('active'));
        const defaultBtn = subBtns.find(b=>b.dataset.lang==='ur') || subBtns[0];
        if(defaultBtn) defaultBtn.classList.add('active');
        render({ type:'sub', lang: defaultBtn ? defaultBtn.dataset.lang : undefined });
      });

      subBtns.forEach(b=>{
        b.addEventListener('click', ()=>{
          subBtns.forEach(x=>x.classList.remove('active'));
          b.classList.add('active');
          render({ type:'sub', lang: b.dataset.lang });
        });
      });
    }

    // small utils
    function escapeHtml(s){ if(!s && s !== 0) return ''; return String(s).replace(/[&<>"'`=\/]/g, function(c){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;','/':'&#x2F;','`':'&#x60;','=':'&#x3D;'}[c]; }); }

    // whatsapp popup
    window.addEventListener('DOMContentLoaded', ()=>{
      setTimeout(()=>{ const p=document.getElementById('whatsappPopup'); if(p) p.style.display='block'; }, 2000);
      const closeBtn = document.getElementById('closeWhatsAppPopup');
      if(closeBtn) closeBtn.onclick = ()=>{ const p=document.getElementById('whatsappPopup'); if(p) p.style.display='none'; };
    });
  })();
  </script>

  <!-- preserve your external ad / script if required -->
  <script type="text/javascript" src="//www.highperformanceformat.com/c91a82435d260630918ecc80c95125ac/invoke.js"></script>

  <!-- Footer Include -->
  <div id="footer-placeholder"></div>
  <script>
  (async function(){
    if (document.readyState !== 'complete')
      await new Promise(r=>window.addEventListener('load',r,{once:true}));
    try{
      const res = await fetch('/includes/footer.html', { cache:'no-cache' });
      if(!res.ok) throw new Error('Footer not found: ' + res.status);
      const html = await res.text();
      document.getElementById('footer-placeholder').innerHTML = html;

      // activate bottom nav highlight based on pathname or last-click
      const nav = document.getElementById('smtv-bottom-nav');
      if(nav){
        const items = Array.from(nav.querySelectorAll('.nav-item'));
        items.forEach(i => i.classList.remove('active'));
        const matched = items.find(i => (i.dataset.name||'').toLowerCase() === 'series' || (i.getAttribute('href')||'').toLowerCase().includes('series'));
        if(matched) matched.classList.add('active');

        // attach click handlers to persist last clicked
        items.forEach(a => {
          a.addEventListener('click', function(e){
            try { e.preventDefault && e.preventDefault(); } catch(e){}
            items.forEach(i=>i.classList.remove('active'));
            this.classList.add('active');
            try { localStorage.setItem('smtv_last_nav', this.dataset.name); } catch(e){}
            const href = this.getAttribute('href');
            if(href) location.assign(href);
          }, { passive:false });
        });
      }
    }catch(e){ console.warn('Footer load failed', e); }
  })();
  </script>
</body>
</html>
