<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Watch short clips from popular Turkish drama series">
    <title>Clips - Turkish Drama Series</title>
    <link rel="stylesheet" href="clips.css">
</head>
<body>

    <!-- Header -->
    <div class="header">
        <button class="back-btn" onclick="window.history.back()" aria-label="Go back">←</button>
        <span>Clips</span>
        <div style="width: 40px;"></div>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner">
        <div class="spinner"></div>
        <p>Loading clips...</p>
    </div>

    <!-- Clips Container -->
    <div class="clips-container" id="clipsContainer">
        <!-- Clips will be dynamically loaded here from clips.json -->
    </div>

    <!-- Footer Include -->
    <div id="footer-placeholder"></div>

    <!-- Error Message -->
    <div id="errorMessage" class="error-message">
        ❌ Unable to load clips. Please check your connection and try again.
    </div>

    <script src="clips.js"></script>
    
    <!-- Footer Loader Script -->
    <script>
    (async function loadFooterAndInit(){
      if (document.readyState !== 'complete') {
        await new Promise(resolve => window.addEventListener('load', resolve, { once: true }));
      }
      try {
        const res = await fetch('/includes/footer.html');
        if (!res.ok) throw new Error('Footer not found: ' + res.status);
        const html = await res.text();
        const ph = document.getElementById('footer-placeholder');
        ph.innerHTML = html;

        const nav = document.getElementById('smtv-bottom-nav');
        if(!nav) return;
        const items = Array.from(nav.querySelectorAll('.nav-item'));
        function clearActive(){ items.forEach(i=>i.classList.remove('active')); }

        const path = window.location.pathname.toLowerCase();
        let matched = items.find(a => {
          const name = (a.dataset.name||'').toLowerCase();
          if (name === 'home' && (path === '/' || path.includes('index'))) return true;
          return name && path.includes(name);
        });

        if(!matched){
          const last = localStorage.getItem('smtv_last_nav');
          if(last) matched = items.find(a => a.dataset.name === last);
        }
        if(matched) matched.classList.add('active');

        items.forEach(a => {
          a.addEventListener('click', function(e){
            clearActive();
            this.classList.add('active');
            try { localStorage.setItem('smtv_last_nav', this.dataset.name); } catch(e){}
            const href = this.getAttribute('href');
            setTimeout(()=> {
              if (location.pathname.toLowerCase() !== new URL(href, location.origin).pathname.toLowerCase()) {
                location.href = href;
              }
            }, 200);
          }, { passive: true });
        });

        try {
          const curPad = parseInt(getComputedStyle(document.body).paddingBottom)||0;
          if(curPad < 96) document.body.style.paddingBottom = 'calc(96px + env(safe-area-inset-bottom))';
        } catch(e){}

      } catch(err) {
        console.warn('Footer load/init error:', err);
      }
    })();
    </script>
</body>
</html>
